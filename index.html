
<html>
    <head>
        <script>
window.onload = (() => {
    /* Create a 2d canvas to render the mandelbrot set in. The rendering happens in a function that takes xMin, xMax, yMin, yMax. */
    var canvas = document.createElement('canvas');
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
    document.body.appendChild(canvas);
    var ctx = canvas.getContext('2d');
    function renderMandelbrot(xMin, xMax, yMin, yMax) {
    var xStep = (xMax - xMin) / canvas.width;
    var yStep = (yMax - yMin) / canvas.height;
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    for (var x = 0; x < canvas.width; x++) {
        for (var y = 0; y < canvas.height; y++) {
        var x0 = xMin + x * xStep;
        var y0 = yMin + y * yStep;
        var x1 = x0;
        var y1 = y0;
        var iteration = 0;
        while (x1 * x1 + y1 * y1 < 4 && iteration < 100) {
            var xtemp = x1 * x1 - y1 * y1 + x0;
            y1 = 2 * x1 * y1 + y0;
            x1 = xtemp;
            iteration++;
        }
        ctx.fillStyle = 'hsl(' + iteration + ', 100%, 50%)';
        ctx.fillRect(x, y, 1, 1);
        }
    }
    }

    /* Use global variables to track the x- and y-range. Initially, it is set to [-1.5, 1.5] for x and [-1, 1] for y. */
    var xMin = -1.5;
    var xMax = 1.5;
    var yMin = -1;
    var yMax = 1;

    /* Render the mandelbrot set. */
    renderMandelbrot(xMin, xMax, yMin, yMax);

    /* create a new function zoom(x, y, scale). This function computes sets the new x- and y-limits , such that xMin = (1-scale)*xMin + scale*x */
    function zoom(x, y, scale) {
        xMin = (1 - scale) * xMin + scale * x;
        xMax = (1 - scale) * xMax + scale * x;
        yMin = (1 - scale) * yMin + scale * y;
        yMax = (1 - scale) * yMax + scale * y;
        renderMandelbrot(xMin, xMax, yMin, yMax);
    }

    /* Use global variables to track the current target position. The user can set the target position by clicking on the canvas. Initially, the target is xTarget = -1.5, yTarget=0 */
    var xTarget = -2; // previously -1.5
    var yTarget = 0;

    /* If the user clicks on the canvas, the click position is evaluated and converted such that left=xMin, right=xMax. The click coordinates become the new target position. */
    canvas.addEventListener('click', function(e) {
        var x = e.pageX - canvas.offsetLeft;
        var y = e.pageY - canvas.offsetTop;
        xTarget = xMin + x * (xMax - xMin) / canvas.width;
        yTarget = yMin + y * (yMax - yMin) / canvas.height;
    });

    /* Create a global variable that tracks the scaling factor. Initially, it is 0.01. When the user presses enter, it increases by 0.01 and if the user presses space, it is set to 0. */
    var scale = 0.01;
        document.addEventListener('keydown', function(e) {
        if (e.keyCode == 13) {
            scale += 0.01;
        } else if (e.keyCode == 32) {
            scale = 0;
        }
    });

    /* Every 50 milliseconds, zoom to the current target position. */
    setInterval(function() {
        zoom(xTarget, yTarget, scale);
    }, 50);
    /* Add a reset button. If the reset button is pressed,  the x- and y-limits are reset to their initial values. */
    var resetButton = document.createElement('button');
    resetButton.innerHTML = 'Reset';
    document.body.appendChild(resetButton);
    resetButton.addEventListener('click', function() {
        xMin = -1.5;
        xMax = 1.5;
        yMin = -1;
        yMax = 1;
        renderMandelbrot(xMin, xMax, yMin, yMax);
    });
    /* If the user presses the right arrow key, xMin and Max are shifted by += 0.1 * (xMax - xMin). Likewise for the left arrow key (now subtract the value) and for the up/down keys (for the y-axis) */
    document.addEventListener('keydown', function(e) {
    if (e.keyCode == 39) {
        xMin += 0.1 * (xMax - xMin);
        xMax += 0.1 * (xMax - xMin);
        renderMandelbrot(xMin, xMax, yMin, yMax);
    } else if (e.keyCode == 37) {
        xMin -= 0.1 * (xMax - xMin);
        xMax -= 0.1 * (xMax - xMin);
        renderMandelbrot(xMin, xMax, yMin, yMax);
    } else if (e.keyCode == 38) {
        yMin -= 0.1 * (yMax - yMin);
        yMax -= 0.1 * (yMax - yMin);
        renderMandelbrot(xMin, xMax, yMin, yMax);
    } else if (e.keyCode == 40) {
        yMin += 0.1 * (yMax - yMin);
        yMax += 0.1 * (yMax - yMin);
        renderMandelbrot(xMin, xMax, yMin, yMax);
    }
    });
});
        </script>
    </head>
    <body style="margin: 0;">
        <div>
            <a href="http://ec2-35-156-197-226.eu-central-1.compute.amazonaws.com:8050/">Dashboard for my master thesis</a>
        </div>
        <p>
            Press space to pause the animation, press Enter (often) to speed it up (more), and click anywhere to mark a target
        </p>
        
    </body>
</html>
